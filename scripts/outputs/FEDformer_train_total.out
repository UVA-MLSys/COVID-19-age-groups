Experiment started at 2023-10-01 22:09:52.743571
Args in experiment:
Namespace(test=False, model='FEDformer', seed=7, root_path='./dataset/processed/', data_path='Total.csv', result_path='scratch', freq='d', no_scale=False, seq_len=14, label_len=7, pred_len=14, top_k=5, num_kernels=6, d_model=64, n_heads=4, e_layers=2, d_layers=1, d_ff=256, moving_avg=7, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, num_workers=-1, train_epochs=10, batch_size=32, patience=3, learning_rate=0.001, des='', loss='MSE', lradj='type1', use_amp=False, no_gpu=False, gpu=0, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[64, 64], p_hidden_layers=2, n_features=10, enc_in=10, dec_in=10, c_out=10, n_targets=1)
Output folder scratch/FEDformer_Total does not exist. Creating ..
Use GPU: cuda:0
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6]
fourier enhanced block used!
modes=32, index=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
 fourier enhanced cross attention used!
modes_q=10, index_q=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
modes_kv=7, index_kv=[0, 1, 2, 3, 4, 5, 6]

Train samples 2001454, validation samples 87976, test samples 87976
637 days of training, 14 days of validation data, 14 days of test data.

Fitting scalers on train data
Loading dataset from ./dataset/processed/Total/train.pt
Loading dataset from ./dataset/processed/Total/val.pt
Loading dataset from ./dataset/processed/Total/test.pt
>>>>>>> training : FEDformer_Total >>>>>>>>>
	iters: 500, epoch: 1 | loss: 0.1483583
	speed: 0.0533s/iter; left time: 15937.9881s
	iters: 1000, epoch: 1 | loss: 0.2176486
	speed: 0.0520s/iter; left time: 15510.1468s
	iters: 1500, epoch: 1 | loss: 0.1243782
	speed: 0.0524s/iter; left time: 15610.6079s
	iters: 2000, epoch: 1 | loss: 0.04979778
	speed: 0.0519s/iter; left time: 15425.2025s
	iters: 2500, epoch: 1 | loss: 0.05419667
	speed: 0.0519s/iter; left time: 15421.5889s
	iters: 3000, epoch: 1 | loss: 0.08486208
	speed: 0.0519s/iter; left time: 15390.9561s
	iters: 3500, epoch: 1 | loss: 1.371716
	speed: 0.0526s/iter; left time: 15555.5850s
	iters: 4000, epoch: 1 | loss: 0.05951183
	speed: 0.0520s/iter; left time: 15366.8889s
	iters: 4500, epoch: 1 | loss: 0.09652809
	speed: 0.0523s/iter; left time: 15434.8836s
	iters: 5000, epoch: 1 | loss: 0.06465492
	speed: 0.0521s/iter; left time: 15329.6965s
	iters: 5500, epoch: 1 | loss: 0.02967971
	speed: 0.0519s/iter; left time: 15270.4704s
	iters: 6000, epoch: 1 | loss: 0.06851625
	speed: 0.0520s/iter; left time: 15246.9156s
	iters: 6500, epoch: 1 | loss: 0.1714793
	speed: 0.0520s/iter; left time: 15235.6686s
	iters: 7000, epoch: 1 | loss: 0.1785432
	speed: 0.0517s/iter; left time: 15124.1374s
	iters: 7500, epoch: 1 | loss: 0.03565767
	speed: 0.0525s/iter; left time: 15330.8695s
	iters: 8000, epoch: 1 | loss: 0.1272648
	speed: 0.0518s/iter; left time: 15095.8199s
	iters: 8500, epoch: 1 | loss: 0.1688717
	speed: 0.0527s/iter; left time: 15326.1395s
	iters: 9000, epoch: 1 | loss: 0.03675578
	speed: 0.0540s/iter; left time: 15694.0196s
	iters: 9500, epoch: 1 | loss: 0.07120917
	speed: 0.0523s/iter; left time: 15151.7054s
	iters: 10000, epoch: 1 | loss: 4.373898
	speed: 0.0524s/iter; left time: 15157.9819s
	iters: 10500, epoch: 1 | loss: 0.117111
	speed: 0.0525s/iter; left time: 15178.6657s
	iters: 11000, epoch: 1 | loss: 0.6221331
	speed: 0.0526s/iter; left time: 15164.0865s
	iters: 11500, epoch: 1 | loss: 1.078956
	speed: 0.0522s/iter; left time: 15046.9898s
	iters: 12000, epoch: 1 | loss: 0.06796639
	speed: 0.0524s/iter; left time: 15065.3009s
	iters: 12500, epoch: 1 | loss: 0.05780528
	speed: 0.0521s/iter; left time: 14940.7626s
	iters: 13000, epoch: 1 | loss: 0.052285
	speed: 0.0526s/iter; left time: 15065.2338s
	iters: 13500, epoch: 1 | loss: 0.1207939
	speed: 0.0523s/iter; left time: 14951.0111s
	iters: 14000, epoch: 1 | loss: 0.2344511
	speed: 0.0525s/iter; left time: 14973.6804s
	iters: 14500, epoch: 1 | loss: 0.08460889
	speed: 0.0557s/iter; left time: 15870.6066s
	iters: 15000, epoch: 1 | loss: 0.08666159
	speed: 0.0530s/iter; left time: 15090.2688s
	iters: 15500, epoch: 1 | loss: 0.2028582
	speed: 0.0525s/iter; left time: 14895.6484s
	iters: 16000, epoch: 1 | loss: 0.1354196
	speed: 0.0520s/iter; left time: 14736.3489s
	iters: 16500, epoch: 1 | loss: 1.751649
	speed: 0.0524s/iter; left time: 14840.1016s
	iters: 17000, epoch: 1 | loss: 0.2598549
	speed: 0.0524s/iter; left time: 14801.6076s
	iters: 17500, epoch: 1 | loss: 0.2310154
	speed: 0.0524s/iter; left time: 14785.1960s
	iters: 18000, epoch: 1 | loss: 2.419404
	speed: 0.0522s/iter; left time: 14701.9630s
	iters: 18500, epoch: 1 | loss: 0.04785204
	speed: 0.0523s/iter; left time: 14708.5069s
	iters: 19000, epoch: 1 | loss: 0.1763818
	speed: 0.0523s/iter; left time: 14671.0776s
	iters: 19500, epoch: 1 | loss: 0.02788709
	speed: 0.0521s/iter; left time: 14591.4798s
	iters: 20000, epoch: 1 | loss: 0.04709894
	speed: 0.0521s/iter; left time: 14556.3906s
	iters: 20500, epoch: 1 | loss: 0.5331532
	speed: 0.0523s/iter; left time: 14596.6973s
	iters: 21000, epoch: 1 | loss: 0.02536703
	speed: 0.0521s/iter; left time: 14521.9654s
	iters: 21500, epoch: 1 | loss: 0.0389099
	speed: 0.0518s/iter; left time: 14406.6929s
	iters: 22000, epoch: 1 | loss: 0.03646051
	speed: 0.0519s/iter; left time: 14398.5035s
	iters: 22500, epoch: 1 | loss: 0.2697422
	speed: 0.0522s/iter; left time: 14457.9211s
	iters: 23000, epoch: 1 | loss: 0.05225531
	speed: 0.0523s/iter; left time: 14461.6692s
	iters: 23500, epoch: 1 | loss: 0.5724288
	speed: 0.0523s/iter; left time: 14433.0662s
	iters: 24000, epoch: 1 | loss: 0.04516542
	speed: 0.0526s/iter; left time: 14481.1258s
	iters: 24500, epoch: 1 | loss: 0.02836555
	speed: 0.0525s/iter; left time: 14426.1738s
	iters: 25000, epoch: 1 | loss: 0.0931484
	speed: 0.0521s/iter; left time: 14301.8127s
	iters: 25500, epoch: 1 | loss: 0.546956
	speed: 0.0522s/iter; left time: 14290.3931s
	iters: 26000, epoch: 1 | loss: 0.618507
	speed: 0.0522s/iter; left time: 14285.3874s
	iters: 26500, epoch: 1 | loss: 0.021875
	speed: 0.0520s/iter; left time: 14183.3696s
	iters: 27000, epoch: 1 | loss: 0.1893512
	speed: 0.0520s/iter; left time: 14172.1070s
	iters: 27500, epoch: 1 | loss: 0.1160284
	speed: 0.0525s/iter; left time: 14273.8910s
	iters: 28000, epoch: 1 | loss: 0.04134279
	speed: 0.0524s/iter; left time: 14214.8577s
	iters: 28500, epoch: 1 | loss: 0.01710153
	speed: 0.0520s/iter; left time: 14079.5283s
	iters: 29000, epoch: 1 | loss: 0.02064947
	speed: 0.0522s/iter; left time: 14127.6168s
	iters: 29500, epoch: 1 | loss: 0.05731136
	speed: 0.0521s/iter; left time: 14061.1957s
Epoch: 1 cost time: 1567.5
Epoch: 1, Steps: 29948 | Train Loss: 0.34198 Vali Loss: 0.46477
Validation loss decreased (inf -> 0.46477). Saving model ...
	iters: 500, epoch: 2 | loss: 0.05443083
	speed: 0.1001s/iter; left time: 26917.8470s
	iters: 1000, epoch: 2 | loss: 0.6604981
	speed: 0.0523s/iter; left time: 14035.6747s
	iters: 1500, epoch: 2 | loss: 0.2518463
	speed: 0.0520s/iter; left time: 13932.3086s
	iters: 2000, epoch: 2 | loss: 0.07822764
	speed: 0.0520s/iter; left time: 13907.4331s
	iters: 2500, epoch: 2 | loss: 0.02452918
	speed: 0.0520s/iter; left time: 13896.2714s
	iters: 3000, epoch: 2 | loss: 0.1276755
	speed: 0.0521s/iter; left time: 13879.9248s
	iters: 3500, epoch: 2 | loss: 0.2117236
	speed: 0.0522s/iter; left time: 13876.9236s
	iters: 4000, epoch: 2 | loss: 0.09254063
	speed: 0.0522s/iter; left time: 13851.8919s
	iters: 4500, epoch: 2 | loss: 0.1540831
	speed: 0.0520s/iter; left time: 13791.4009s
	iters: 5000, epoch: 2 | loss: 0.1759856
	speed: 0.0525s/iter; left time: 13895.8812s
	iters: 5500, epoch: 2 | loss: 0.201
	speed: 0.0521s/iter; left time: 13743.0140s
	iters: 6000, epoch: 2 | loss: 0.05385038
	speed: 0.0521s/iter; left time: 13736.4656s
	iters: 6500, epoch: 2 | loss: 0.06227689
	speed: 0.0524s/iter; left time: 13770.8636s
	iters: 7000, epoch: 2 | loss: 0.07919846
	speed: 0.0523s/iter; left time: 13735.9380s
	iters: 7500, epoch: 2 | loss: 0.03239959
	speed: 0.0521s/iter; left time: 13662.2403s
	iters: 8000, epoch: 2 | loss: 0.05279218
	speed: 0.0523s/iter; left time: 13687.3881s
	iters: 8500, epoch: 2 | loss: 0.06674846
	speed: 0.0522s/iter; left time: 13631.7829s
	iters: 9000, epoch: 2 | loss: 0.02980297
	speed: 0.0524s/iter; left time: 13642.8078s
	iters: 9500, epoch: 2 | loss: 0.052349
	speed: 0.0524s/iter; left time: 13634.6074s
	iters: 10000, epoch: 2 | loss: 0.05226886
	speed: 0.0522s/iter; left time: 13548.2841s
	iters: 10500, epoch: 2 | loss: 0.147422
	speed: 0.0524s/iter; left time: 13568.0531s
	iters: 11000, epoch: 2 | loss: 1.139004
	speed: 0.0524s/iter; left time: 13554.5368s
	iters: 11500, epoch: 2 | loss: 0.04848714
	speed: 0.0523s/iter; left time: 13490.3417s
	iters: 12000, epoch: 2 | loss: 0.03451838
	speed: 0.0524s/iter; left time: 13486.1070s
	iters: 12500, epoch: 2 | loss: 0.3756638
	speed: 0.0524s/iter; left time: 13457.9367s
	iters: 13000, epoch: 2 | loss: 0.01697274
	speed: 0.0527s/iter; left time: 13524.7293s
	iters: 13500, epoch: 2 | loss: 0.2281665
	speed: 0.0525s/iter; left time: 13432.5403s
	iters: 14000, epoch: 2 | loss: 2.21467
	speed: 0.0524s/iter; left time: 13382.7932s
	iters: 14500, epoch: 2 | loss: 0.04446582
	speed: 0.0524s/iter; left time: 13351.8734s
	iters: 15000, epoch: 2 | loss: 0.0384552
	speed: 0.0527s/iter; left time: 13420.2335s
	iters: 15500, epoch: 2 | loss: 0.008270772
	speed: 0.0523s/iter; left time: 13294.3933s
	iters: 16000, epoch: 2 | loss: 0.04871503
	speed: 0.0528s/iter; left time: 13381.6692s
	iters: 16500, epoch: 2 | loss: 0.09345551
	speed: 0.0523s/iter; left time: 13227.7722s
	iters: 17000, epoch: 2 | loss: 0.02262935
	speed: 0.0527s/iter; left time: 13306.1752s
	iters: 17500, epoch: 2 | loss: 0.1001336
	speed: 0.0524s/iter; left time: 13218.1844s
	iters: 18000, epoch: 2 | loss: 0.06898628
	speed: 0.0525s/iter; left time: 13193.0179s
	iters: 18500, epoch: 2 | loss: 0.4845467
	speed: 0.0528s/iter; left time: 13242.6268s
	iters: 19000, epoch: 2 | loss: 0.06292662
	speed: 0.0520s/iter; left time: 13026.3143s
	iters: 19500, epoch: 2 | loss: 33.37001
	speed: 0.0523s/iter; left time: 13073.6083s
	iters: 20000, epoch: 2 | loss: 0.4153067
	speed: 0.0526s/iter; left time: 13118.5324s
	iters: 20500, epoch: 2 | loss: 0.0431907
	speed: 0.0523s/iter; left time: 13035.3584s
	iters: 21000, epoch: 2 | loss: 0.05895841
	speed: 0.0524s/iter; left time: 13029.4996s
	iters: 21500, epoch: 2 | loss: 0.08044302
	speed: 0.0528s/iter; left time: 13090.9059s
	iters: 22000, epoch: 2 | loss: 0.1378021
	speed: 0.0524s/iter; left time: 12980.1212s
	iters: 22500, epoch: 2 | loss: 0.06398513
	speed: 0.0523s/iter; left time: 12925.1616s
	iters: 23000, epoch: 2 | loss: 0.1432711
	speed: 0.0523s/iter; left time: 12901.0397s
	iters: 23500, epoch: 2 | loss: 0.0372316
	speed: 0.0525s/iter; left time: 12923.3781s
	iters: 24000, epoch: 2 | loss: 0.02415965
	speed: 0.0523s/iter; left time: 12851.2506s
	iters: 24500, epoch: 2 | loss: 0.2026628
	speed: 0.0522s/iter; left time: 12785.1870s
	iters: 25000, epoch: 2 | loss: 0.04251296
	speed: 0.0527s/iter; left time: 12887.5299s
	iters: 25500, epoch: 2 | loss: 2.927103
	speed: 0.0523s/iter; left time: 12760.5465s
	iters: 26000, epoch: 2 | loss: 0.1740303
	speed: 0.0524s/iter; left time: 12768.6711s
	iters: 26500, epoch: 2 | loss: 0.05262369
	speed: 0.0521s/iter; left time: 12662.4835s
	iters: 27000, epoch: 2 | loss: 0.04369308
	speed: 0.0526s/iter; left time: 12760.6945s
	iters: 27500, epoch: 2 | loss: 0.04508088
	speed: 0.0528s/iter; left time: 12782.7080s
	iters: 28000, epoch: 2 | loss: 0.1044936
	speed: 0.0521s/iter; left time: 12583.1607s
	iters: 28500, epoch: 2 | loss: 0.09484928
	speed: 0.0527s/iter; left time: 12697.8878s
	iters: 29000, epoch: 2 | loss: 0.06440635
	speed: 0.0526s/iter; left time: 12657.1960s
	iters: 29500, epoch: 2 | loss: 0.3483462
	speed: 0.0524s/iter; left time: 12581.9735s
Epoch: 2 cost time: 1568.6
Epoch: 2, Steps: 29948 | Train Loss: 0.32828 Vali Loss: 0.48267
EarlyStopping counter: 1 out of 3
Epoch 00002: reducing learning rate of group 0 to 1.0000e-04.
	iters: 500, epoch: 3 | loss: 0.08979612
	speed: 0.1005s/iter; left time: 24023.2819s
	iters: 1000, epoch: 3 | loss: 0.03425465
	speed: 0.0521s/iter; left time: 12430.9459s
	iters: 1500, epoch: 3 | loss: 1.547278
	speed: 0.0524s/iter; left time: 12474.5307s
	iters: 2000, epoch: 3 | loss: 0.04546542
	speed: 0.0523s/iter; left time: 12433.6524s
	iters: 2500, epoch: 3 | loss: 0.09531119
	speed: 0.0526s/iter; left time: 12475.0437s
	iters: 3000, epoch: 3 | loss: 0.08078662
	speed: 0.0526s/iter; left time: 12448.0665s
	iters: 3500, epoch: 3 | loss: 0.0319651
	speed: 0.0528s/iter; left time: 12454.9782s
	iters: 4000, epoch: 3 | loss: 0.3628933
	speed: 0.0523s/iter; left time: 12317.2567s
	iters: 4500, epoch: 3 | loss: 0.1327626
	speed: 0.0523s/iter; left time: 12303.4162s
	iters: 5000, epoch: 3 | loss: 0.09483927
	speed: 0.0525s/iter; left time: 12324.9023s
	iters: 5500, epoch: 3 | loss: 0.2512625
	speed: 0.0521s/iter; left time: 12197.1150s
	iters: 6000, epoch: 3 | loss: 0.09598939
	speed: 0.0520s/iter; left time: 12140.6114s
	iters: 6500, epoch: 3 | loss: 0.234949
	speed: 0.0524s/iter; left time: 12213.6519s
	iters: 7000, epoch: 3 | loss: 0.06666432
	speed: 0.0524s/iter; left time: 12193.8378s
	iters: 7500, epoch: 3 | loss: 0.05002616
	speed: 0.0525s/iter; left time: 12176.8829s
	iters: 8000, epoch: 3 | loss: 0.3827648
	speed: 0.0523s/iter; left time: 12111.7886s
	iters: 8500, epoch: 3 | loss: 0.36219
	speed: 0.0526s/iter; left time: 12164.4783s
	iters: 9000, epoch: 3 | loss: 0.3114143
	speed: 0.0520s/iter; left time: 11997.2537s
	iters: 9500, epoch: 3 | loss: 0.02019401
	speed: 0.0521s/iter; left time: 11988.1453s
	iters: 10000, epoch: 3 | loss: 0.3089746
	speed: 0.0523s/iter; left time: 12015.5492s
	iters: 10500, epoch: 3 | loss: 0.05198215
	speed: 0.0523s/iter; left time: 11991.7537s
	iters: 11000, epoch: 3 | loss: 0.1239934
	speed: 0.0524s/iter; left time: 11967.3937s
	iters: 11500, epoch: 3 | loss: 0.01475002
	speed: 0.0524s/iter; left time: 11958.7473s
	iters: 12000, epoch: 3 | loss: 0.09067468
	speed: 0.0522s/iter; left time: 11885.2629s
	iters: 12500, epoch: 3 | loss: 0.2034572
	speed: 0.0525s/iter; left time: 11911.6436s
	iters: 13000, epoch: 3 | loss: 0.02630311
	speed: 0.0521s/iter; left time: 11802.1605s
	iters: 13500, epoch: 3 | loss: 0.3619234
	speed: 0.0524s/iter; left time: 11839.9515s
	iters: 14000, epoch: 3 | loss: 1.094659
	speed: 0.0525s/iter; left time: 11849.0977s
	iters: 14500, epoch: 3 | loss: 0.3387926
	speed: 0.0522s/iter; left time: 11754.0371s
	iters: 15000, epoch: 3 | loss: 0.01800068
	speed: 0.0522s/iter; left time: 11727.3374s
	iters: 15500, epoch: 3 | loss: 0.03937191
	speed: 0.0520s/iter; left time: 11659.1459s
	iters: 16000, epoch: 3 | loss: 0.06656773
	speed: 0.0522s/iter; left time: 11663.9445s
	iters: 16500, epoch: 3 | loss: 0.06448954
	speed: 0.0525s/iter; left time: 11717.2906s
	iters: 17000, epoch: 3 | loss: 0.02071052
	speed: 0.0522s/iter; left time: 11607.8718s
	iters: 17500, epoch: 3 | loss: 0.03615702
	speed: 0.0524s/iter; left time: 11646.5161s
	iters: 18000, epoch: 3 | loss: 0.05726536
	speed: 0.0521s/iter; left time: 11553.7288s
	iters: 18500, epoch: 3 | loss: 0.1610074
	speed: 0.0524s/iter; left time: 11581.3152s
	iters: 19000, epoch: 3 | loss: 0.03951709
	speed: 0.0523s/iter; left time: 11540.7922s
	iters: 19500, epoch: 3 | loss: 0.01128432
	speed: 0.0520s/iter; left time: 11433.9014s
	iters: 20000, epoch: 3 | loss: 0.05008287
	speed: 0.0525s/iter; left time: 11537.5113s
	iters: 20500, epoch: 3 | loss: 0.04688115
	speed: 0.0525s/iter; left time: 11497.0413s
	iters: 21000, epoch: 3 | loss: 2.367415
	speed: 0.0521s/iter; left time: 11389.0904s
	iters: 21500, epoch: 3 | loss: 0.169835
	speed: 0.0521s/iter; left time: 11367.2994s
	iters: 22000, epoch: 3 | loss: 0.1640471
	speed: 0.0521s/iter; left time: 11325.4159s
	iters: 22500, epoch: 3 | loss: 0.2942753
	speed: 0.0524s/iter; left time: 11379.3156s
	iters: 23000, epoch: 3 | loss: 0.1216114
	speed: 0.0520s/iter; left time: 11270.3859s
	iters: 23500, epoch: 3 | loss: 0.05003554
	speed: 0.0524s/iter; left time: 11317.6477s
	iters: 24000, epoch: 3 | loss: 0.8568729
	speed: 0.0520s/iter; left time: 11217.3371s
	iters: 24500, epoch: 3 | loss: 0.02834626
	speed: 0.0522s/iter; left time: 11222.1707s
	iters: 25000, epoch: 3 | loss: 0.07056367
	speed: 0.0523s/iter; left time: 11224.5018s
	iters: 25500, epoch: 3 | loss: 0.2549259
	speed: 0.0524s/iter; left time: 11208.3008s
	iters: 26000, epoch: 3 | loss: 0.283151
	speed: 0.0526s/iter; left time: 11233.3854s
	iters: 26500, epoch: 3 | loss: 0.04903599
	speed: 0.0524s/iter; left time: 11172.6772s
	iters: 27000, epoch: 3 | loss: 0.06526166
	speed: 0.0522s/iter; left time: 11089.2681s
	iters: 27500, epoch: 3 | loss: 0.3516664
	speed: 0.0522s/iter; left time: 11069.2016s
	iters: 28000, epoch: 3 | loss: 0.0221376
	speed: 0.0525s/iter; left time: 11106.4513s
	iters: 28500, epoch: 3 | loss: 0.02751817
	speed: 0.0523s/iter; left time: 11034.1821s
	iters: 29000, epoch: 3 | loss: 0.05450037
	speed: 0.0522s/iter; left time: 10983.6151s
	iters: 29500, epoch: 3 | loss: 0.1727808
	speed: 0.0524s/iter; left time: 11018.1444s
Epoch: 3 cost time: 1566.6
Epoch: 3, Steps: 29948 | Train Loss: 0.31046 Vali Loss: 0.45291
Validation loss decreased (0.46477 -> 0.45291). Saving model ...
	iters: 500, epoch: 4 | loss: 0.05053449
	speed: 0.0994s/iter; left time: 20778.8757s
	iters: 1000, epoch: 4 | loss: 0.2074535
	speed: 0.0520s/iter; left time: 10846.9502s
	iters: 1500, epoch: 4 | loss: 0.07023099
	speed: 0.0524s/iter; left time: 10906.4703s
	iters: 2000, epoch: 4 | loss: 0.03594161
	speed: 0.0526s/iter; left time: 10931.3838s
	iters: 2500, epoch: 4 | loss: 0.8041911
	speed: 0.0525s/iter; left time: 10883.4781s
	iters: 3000, epoch: 4 | loss: 1.753519
	speed: 0.0569s/iter; left time: 11754.2156s
	iters: 3500, epoch: 4 | loss: 0.0839103
	speed: 0.0520s/iter; left time: 10710.6082s
	iters: 4000, epoch: 4 | loss: 0.0660854
	speed: 0.0514s/iter; left time: 10579.1549s
	iters: 4500, epoch: 4 | loss: 0.06658114
	speed: 0.0515s/iter; left time: 10560.0144s
	iters: 5000, epoch: 4 | loss: 0.6849595
	speed: 0.0518s/iter; left time: 10593.6718s
	iters: 5500, epoch: 4 | loss: 0.0519695
	speed: 0.0523s/iter; left time: 10677.0909s
	iters: 6000, epoch: 4 | loss: 0.09091856
	speed: 0.0523s/iter; left time: 10659.1546s
	iters: 6500, epoch: 4 | loss: 0.0138424
	speed: 0.0525s/iter; left time: 10659.4856s
	iters: 7000, epoch: 4 | loss: 0.03559203
	speed: 0.0524s/iter; left time: 10609.9027s
	iters: 7500, epoch: 4 | loss: 0.1624375
	speed: 0.0525s/iter; left time: 10602.7006s
	iters: 8000, epoch: 4 | loss: 0.1403273
	speed: 0.0526s/iter; left time: 10603.7010s
	iters: 8500, epoch: 4 | loss: 0.05945474
	speed: 0.0529s/iter; left time: 10641.0471s
	iters: 9000, epoch: 4 | loss: 0.09560655
	speed: 0.0528s/iter; left time: 10588.6001s
	iters: 9500, epoch: 4 | loss: 0.04517497
	speed: 0.0523s/iter; left time: 10474.3528s
	iters: 10000, epoch: 4 | loss: 0.1753121
	speed: 0.0524s/iter; left time: 10468.2075s
	iters: 10500, epoch: 4 | loss: 0.04147022
	speed: 0.0522s/iter; left time: 10390.0867s
	iters: 11000, epoch: 4 | loss: 0.3667389
	speed: 0.0526s/iter; left time: 10444.1031s
	iters: 11500, epoch: 4 | loss: 0.1211413
	speed: 0.0523s/iter; left time: 10366.0731s
	iters: 12000, epoch: 4 | loss: 0.06097708
	speed: 0.0526s/iter; left time: 10389.4248s
	iters: 12500, epoch: 4 | loss: 0.02376753
	speed: 0.0523s/iter; left time: 10317.6520s
	iters: 13000, epoch: 4 | loss: 0.04283011
	speed: 0.0520s/iter; left time: 10231.2810s
	iters: 13500, epoch: 4 | loss: 0.09249468
	speed: 0.0522s/iter; left time: 10245.3565s
	iters: 14000, epoch: 4 | loss: 0.2618777
	speed: 0.0524s/iter; left time: 10252.8914s
	iters: 14500, epoch: 4 | loss: 0.3559203
	speed: 0.0523s/iter; left time: 10196.1273s
	iters: 15000, epoch: 4 | loss: 1.137416
	speed: 0.0520s/iter; left time: 10124.9677s
	iters: 15500, epoch: 4 | loss: 0.8646554
	speed: 0.0521s/iter; left time: 10106.4957s
	iters: 16000, epoch: 4 | loss: 0.1148506
	speed: 0.0520s/iter; left time: 10078.1545s
	iters: 16500, epoch: 4 | loss: 0.1504554
	speed: 0.0522s/iter; left time: 10082.6642s
	iters: 17000, epoch: 4 | loss: 0.1215355
	speed: 0.0525s/iter; left time: 10111.4928s
	iters: 17500, epoch: 4 | loss: 0.07548305
	speed: 0.0525s/iter; left time: 10087.7810s
	iters: 18000, epoch: 4 | loss: 0.1133706
	speed: 0.0524s/iter; left time: 10045.7279s
	iters: 18500, epoch: 4 | loss: 0.02409141
	speed: 0.0522s/iter; left time: 9974.1103s
	iters: 19000, epoch: 4 | loss: 0.06869636
	speed: 0.0521s/iter; left time: 9930.0233s
	iters: 19500, epoch: 4 | loss: 0.1494914
	speed: 0.0522s/iter; left time: 9917.2536s
	iters: 20000, epoch: 4 | loss: 0.1843293
	speed: 0.0524s/iter; left time: 9938.0023s
	iters: 20500, epoch: 4 | loss: 0.07015064
	speed: 0.0524s/iter; left time: 9902.7997s
	iters: 21000, epoch: 4 | loss: 4.982572
	speed: 0.0523s/iter; left time: 9859.6228s
	iters: 21500, epoch: 4 | loss: 0.0427223
	speed: 0.0522s/iter; left time: 9821.7839s
	iters: 22000, epoch: 4 | loss: 0.04662815
	speed: 0.0524s/iter; left time: 9823.4098s
	iters: 22500, epoch: 4 | loss: 0.01571398
	speed: 0.0524s/iter; left time: 9814.7888s
	iters: 23000, epoch: 4 | loss: 0.07302971
	speed: 0.0525s/iter; left time: 9797.3972s
	iters: 23500, epoch: 4 | loss: 0.05220584
	speed: 0.0522s/iter; left time: 9714.4339s
	iters: 24000, epoch: 4 | loss: 0.1087062
	speed: 0.0527s/iter; left time: 9773.9020s
	iters: 24500, epoch: 4 | loss: 0.04295786
	speed: 0.0522s/iter; left time: 9670.0216s
	iters: 25000, epoch: 4 | loss: 0.08516634
	speed: 0.0522s/iter; left time: 9646.2431s
	iters: 25500, epoch: 4 | loss: 0.01478807
	speed: 0.0520s/iter; left time: 9583.1153s
	iters: 26000, epoch: 4 | loss: 0.3447102
	speed: 0.0523s/iter; left time: 9608.6243s
	iters: 26500, epoch: 4 | loss: 0.0246761
	speed: 0.0521s/iter; left time: 9538.4675s
	iters: 27000, epoch: 4 | loss: 0.05541623
	speed: 0.0530s/iter; left time: 9675.0029s
	iters: 27500, epoch: 4 | loss: 0.02497677
	speed: 0.0523s/iter; left time: 9525.2849s
	iters: 28000, epoch: 4 | loss: 1.234837
	speed: 0.0520s/iter; left time: 9451.5619s
	iters: 28500, epoch: 4 | loss: 0.04814459
	speed: 0.0523s/iter; left time: 9472.8192s
	iters: 29000, epoch: 4 | loss: 0.02610437
	speed: 0.0522s/iter; left time: 9434.6295s
	iters: 29500, epoch: 4 | loss: 0.1175517
	speed: 0.0522s/iter; left time: 9395.1404s
Epoch: 4 cost time: 1568.3
Epoch: 4, Steps: 29948 | Train Loss: 0.30417 Vali Loss: 0.46111
EarlyStopping counter: 1 out of 3
Epoch 00004: reducing learning rate of group 0 to 1.0000e-05.
	iters: 500, epoch: 5 | loss: 0.03386277
	speed: 0.0998s/iter; left time: 17881.9658s
	iters: 1000, epoch: 5 | loss: 1.329898
	speed: 0.0522s/iter; left time: 9333.9134s
	iters: 1500, epoch: 5 | loss: 0.113401
	speed: 0.0522s/iter; left time: 9310.1007s
	iters: 2000, epoch: 5 | loss: 0.09341721
	speed: 0.0523s/iter; left time: 9292.8287s
	iters: 2500, epoch: 5 | loss: 0.04648242
	speed: 0.0522s/iter; left time: 9243.7774s
	iters: 3000, epoch: 5 | loss: 0.3354224
	speed: 0.0520s/iter; left time: 9181.7903s
	iters: 3500, epoch: 5 | loss: 1.416341
	speed: 0.0518s/iter; left time: 9129.9680s
	iters: 4000, epoch: 5 | loss: 0.1133956
	speed: 0.0524s/iter; left time: 9209.4194s
	iters: 4500, epoch: 5 | loss: 0.0109682
	speed: 0.0516s/iter; left time: 9034.1416s
	iters: 5000, epoch: 5 | loss: 0.6200329
	speed: 0.0522s/iter; left time: 9125.5459s
	iters: 5500, epoch: 5 | loss: 0.03921732
	speed: 0.0520s/iter; left time: 9056.5043s
	iters: 6000, epoch: 5 | loss: 0.03352322
	speed: 0.0519s/iter; left time: 9013.6643s
	iters: 6500, epoch: 5 | loss: 0.2524372
	speed: 0.0521s/iter; left time: 9029.2558s
	iters: 7000, epoch: 5 | loss: 0.08931368
	speed: 0.0521s/iter; left time: 8990.3366s
	iters: 7500, epoch: 5 | loss: 0.1644118
	speed: 0.0521s/iter; left time: 8965.0803s
	iters: 8000, epoch: 5 | loss: 0.04044811
	speed: 0.0520s/iter; left time: 8928.1745s
	iters: 8500, epoch: 5 | loss: 0.05643855
	speed: 0.0517s/iter; left time: 8843.3703s
	iters: 9000, epoch: 5 | loss: 0.1698318
	speed: 0.0517s/iter; left time: 8832.7794s
	iters: 9500, epoch: 5 | loss: 0.0347034
	speed: 0.0521s/iter; left time: 8866.2222s
	iters: 10000, epoch: 5 | loss: 0.2640579
	speed: 0.0522s/iter; left time: 8865.2662s
	iters: 10500, epoch: 5 | loss: 0.401996
	speed: 0.0520s/iter; left time: 8801.8293s
	iters: 11000, epoch: 5 | loss: 0.2482032
	speed: 0.0521s/iter; left time: 8788.4406s
	iters: 11500, epoch: 5 | loss: 0.121394
	speed: 0.0521s/iter; left time: 8756.9633s
	iters: 12000, epoch: 5 | loss: 0.05272821
	speed: 0.0522s/iter; left time: 8749.8299s
	iters: 12500, epoch: 5 | loss: 0.1912925
	speed: 0.0521s/iter; left time: 8702.9800s
	iters: 13000, epoch: 5 | loss: 0.07518726
	speed: 0.0521s/iter; left time: 8691.7288s
	iters: 13500, epoch: 5 | loss: 0.01408447
	speed: 0.0522s/iter; left time: 8672.6949s
	iters: 14000, epoch: 5 | loss: 0.03262496
	speed: 0.0524s/iter; left time: 8674.1566s
	iters: 14500, epoch: 5 | loss: 0.7651386
	speed: 0.0521s/iter; left time: 8609.9485s
	iters: 15000, epoch: 5 | loss: 0.3142926
	speed: 0.0518s/iter; left time: 8538.0108s
	iters: 15500, epoch: 5 | loss: 0.01311353
	speed: 0.0521s/iter; left time: 8552.4631s
	iters: 16000, epoch: 5 | loss: 0.1917191
	speed: 0.0524s/iter; left time: 8583.5344s
	iters: 16500, epoch: 5 | loss: 0.01901869
	speed: 0.0525s/iter; left time: 8559.8597s
	iters: 17000, epoch: 5 | loss: 0.05301786
	speed: 0.0524s/iter; left time: 8522.5500s
	iters: 17500, epoch: 5 | loss: 0.01722039
	speed: 0.0517s/iter; left time: 8380.4100s
	iters: 18000, epoch: 5 | loss: 0.04948796
	speed: 0.0523s/iter; left time: 8455.2018s
	iters: 18500, epoch: 5 | loss: 0.1008644
	speed: 0.0522s/iter; left time: 8417.3694s
	iters: 19000, epoch: 5 | loss: 0.4331207
	speed: 0.0522s/iter; left time: 8387.8852s
	iters: 19500, epoch: 5 | loss: 0.0587522
	speed: 0.0525s/iter; left time: 8405.4617s
	iters: 20000, epoch: 5 | loss: 0.1080623
	speed: 0.0525s/iter; left time: 8376.1514s
	iters: 20500, epoch: 5 | loss: 0.02870891
	speed: 0.0520s/iter; left time: 8270.3628s
	iters: 21000, epoch: 5 | loss: 0.156621
	speed: 0.0522s/iter; left time: 8280.7855s
	iters: 21500, epoch: 5 | loss: 0.1053448
	speed: 0.0523s/iter; left time: 8275.7026s
	iters: 22000, epoch: 5 | loss: 0.1306386
	speed: 0.0523s/iter; left time: 8244.5857s
	iters: 22500, epoch: 5 | loss: 0.1558547
	speed: 0.0524s/iter; left time: 8230.6017s
	iters: 23000, epoch: 5 | loss: 0.08178447
	speed: 0.0525s/iter; left time: 8227.3591s
	iters: 23500, epoch: 5 | loss: 0.02595083
	speed: 0.0525s/iter; left time: 8196.5667s
	iters: 24000, epoch: 5 | loss: 0.08889047
	speed: 0.0521s/iter; left time: 8105.2342s
	iters: 24500, epoch: 5 | loss: 0.0296933
	speed: 0.0524s/iter; left time: 8130.2323s
	iters: 25000, epoch: 5 | loss: 0.2430025
	speed: 0.0524s/iter; left time: 8100.4533s
	iters: 25500, epoch: 5 | loss: 0.03367478
	speed: 0.0525s/iter; left time: 8101.3369s
	iters: 26000, epoch: 5 | loss: 0.07680581
	speed: 0.0524s/iter; left time: 8060.8199s
	iters: 26500, epoch: 5 | loss: 0.03875108
	speed: 0.0520s/iter; left time: 7972.5378s
	iters: 27000, epoch: 5 | loss: 0.03689139
	speed: 0.0525s/iter; left time: 8012.2027s
	iters: 27500, epoch: 5 | loss: 0.1598231
	speed: 0.0523s/iter; left time: 7960.1666s
	iters: 28000, epoch: 5 | loss: 0.05207207
	speed: 0.0528s/iter; left time: 8005.4540s
	iters: 28500, epoch: 5 | loss: 0.0594946
	speed: 0.0533s/iter; left time: 8061.3907s
	iters: 29000, epoch: 5 | loss: 0.1420033
	speed: 0.0521s/iter; left time: 7853.8599s
	iters: 29500, epoch: 5 | loss: 0.1992712
	speed: 0.0525s/iter; left time: 7882.8204s
Epoch: 5 cost time: 1563.7
Epoch: 5, Steps: 29948 | Train Loss: 0.30421 Vali Loss: 0.45372
EarlyStopping counter: 2 out of 3
	iters: 500, epoch: 6 | loss: 0.05810924
	speed: 0.1000s/iter; left time: 14921.1961s
	iters: 1000, epoch: 6 | loss: 0.4665768
	speed: 0.0522s/iter; left time: 7759.0514s
	iters: 1500, epoch: 6 | loss: 0.01908346
	speed: 0.0525s/iter; left time: 7779.2458s
	iters: 2000, epoch: 6 | loss: 0.05032744
	speed: 0.0523s/iter; left time: 7720.5126s
	iters: 2500, epoch: 6 | loss: 0.1142788
	speed: 0.0523s/iter; left time: 7704.1941s
	iters: 3000, epoch: 6 | loss: 0.1544319
	speed: 0.0522s/iter; left time: 7657.9688s
	iters: 3500, epoch: 6 | loss: 0.2013888
	speed: 0.0525s/iter; left time: 7679.9174s
	iters: 4000, epoch: 6 | loss: 5.747527
	speed: 0.0521s/iter; left time: 7586.9195s
	iters: 4500, epoch: 6 | loss: 0.05984344
	speed: 0.0521s/iter; left time: 7572.5487s
	iters: 5000, epoch: 6 | loss: 0.06782886
	speed: 0.0519s/iter; left time: 7508.5987s
	iters: 5500, epoch: 6 | loss: 0.04400865
	speed: 0.0523s/iter; left time: 7543.5716s
	iters: 6000, epoch: 6 | loss: 0.1034238
	speed: 0.0520s/iter; left time: 7476.8978s
	iters: 6500, epoch: 6 | loss: 0.269868
	speed: 0.0524s/iter; left time: 7511.5815s
	iters: 7000, epoch: 6 | loss: 0.03321512
	speed: 0.0523s/iter; left time: 7460.2599s
	iters: 7500, epoch: 6 | loss: 0.02160451
	speed: 0.0520s/iter; left time: 7402.0171s
	iters: 8000, epoch: 6 | loss: 0.01983311
	speed: 0.0518s/iter; left time: 7348.6592s
	iters: 8500, epoch: 6 | loss: 0.2409931
	speed: 0.0521s/iter; left time: 7360.7208s
	iters: 9000, epoch: 6 | loss: 0.05225808
	speed: 0.0528s/iter; left time: 7431.2867s
	iters: 9500, epoch: 6 | loss: 0.08735792
	speed: 0.0524s/iter; left time: 7342.2944s
	iters: 10000, epoch: 6 | loss: 0.139611
	speed: 0.0525s/iter; left time: 7335.3926s
	iters: 10500, epoch: 6 | loss: 0.1147591
	speed: 0.0527s/iter; left time: 7341.0336s
	iters: 11000, epoch: 6 | loss: 0.04342939
	speed: 0.0523s/iter; left time: 7254.6493s
	iters: 11500, epoch: 6 | loss: 0.3883272
	speed: 0.0524s/iter; left time: 7241.5650s
	iters: 12000, epoch: 6 | loss: 0.2063019
	speed: 0.0521s/iter; left time: 7180.4283s
	iters: 12500, epoch: 6 | loss: 0.04322695
	speed: 0.0524s/iter; left time: 7197.4024s
	iters: 13000, epoch: 6 | loss: 0.07529269
	speed: 0.0525s/iter; left time: 7180.2036s
	iters: 13500, epoch: 6 | loss: 0.01381991
	speed: 0.0528s/iter; left time: 7191.3573s
	iters: 14000, epoch: 6 | loss: 0.04412521
	speed: 0.0530s/iter; left time: 7200.8081s
	iters: 14500, epoch: 6 | loss: 0.02595215
	speed: 0.0530s/iter; left time: 7170.2742s
	iters: 15000, epoch: 6 | loss: 0.1089031
	speed: 0.0522s/iter; left time: 7040.0042s
	iters: 15500, epoch: 6 | loss: 0.02906848
	speed: 0.0523s/iter; left time: 7026.9777s
	iters: 16000, epoch: 6 | loss: 0.03966267
	speed: 0.0523s/iter; left time: 7001.1572s
	iters: 16500, epoch: 6 | loss: 0.01599406
	speed: 0.0526s/iter; left time: 7002.2868s
	iters: 17000, epoch: 6 | loss: 0.04742071
	speed: 0.0520s/iter; left time: 6907.8264s
	iters: 17500, epoch: 6 | loss: 0.062909
	speed: 0.0524s/iter; left time: 6923.4655s
	iters: 18000, epoch: 6 | loss: 0.1161596
	speed: 0.0525s/iter; left time: 6913.0913s
	iters: 18500, epoch: 6 | loss: 0.9281379
	speed: 0.0528s/iter; left time: 6928.7999s
	iters: 19000, epoch: 6 | loss: 0.03051847
	speed: 0.0524s/iter; left time: 6855.0036s
	iters: 19500, epoch: 6 | loss: 0.03527077
	speed: 0.0524s/iter; left time: 6829.6253s
	iters: 20000, epoch: 6 | loss: 0.07143068
	speed: 0.0529s/iter; left time: 6862.9649s
	iters: 20500, epoch: 6 | loss: 0.02608414
	speed: 0.0527s/iter; left time: 6815.8047s
	iters: 21000, epoch: 6 | loss: 0.04828212
	speed: 0.0558s/iter; left time: 7186.6595s
	iters: 21500, epoch: 6 | loss: 0.02955684
	speed: 0.0533s/iter; left time: 6833.0048s
	iters: 22000, epoch: 6 | loss: 0.1110956
	speed: 0.0521s/iter; left time: 6654.4763s
	iters: 22500, epoch: 6 | loss: 0.206613
	speed: 0.0523s/iter; left time: 6659.5615s
	iters: 23000, epoch: 6 | loss: 0.8000043
	speed: 0.0520s/iter; left time: 6588.7387s
	iters: 23500, epoch: 6 | loss: 0.09902101
	speed: 0.0522s/iter; left time: 6593.0393s
	iters: 24000, epoch: 6 | loss: 2.690774
	speed: 0.0521s/iter; left time: 6553.2531s
	iters: 24500, epoch: 6 | loss: 0.08820507
	speed: 0.0524s/iter; left time: 6558.6062s
	iters: 25000, epoch: 6 | loss: 0.0187645
	speed: 0.0522s/iter; left time: 6514.8856s
	iters: 25500, epoch: 6 | loss: 0.8058468
	speed: 0.0518s/iter; left time: 6435.5197s
	iters: 26000, epoch: 6 | loss: 0.03779266
	speed: 0.0528s/iter; left time: 6536.4364s
	iters: 26500, epoch: 6 | loss: 3.499837
	speed: 0.0521s/iter; left time: 6414.7696s
	iters: 27000, epoch: 6 | loss: 0.07207612
	speed: 0.0525s/iter; left time: 6442.9781s
	iters: 27500, epoch: 6 | loss: 0.0252973
	speed: 0.0526s/iter; left time: 6426.2355s
	iters: 28000, epoch: 6 | loss: 0.8050638
	speed: 0.0524s/iter; left time: 6374.7989s
	iters: 28500, epoch: 6 | loss: 0.09345866
	speed: 0.0522s/iter; left time: 6330.5144s
	iters: 29000, epoch: 6 | loss: 0.06563854
	speed: 0.0521s/iter; left time: 6285.0974s
	iters: 29500, epoch: 6 | loss: 0.1749007
	speed: 0.0520s/iter; left time: 6249.4297s
Epoch: 6 cost time: 1569.9
Epoch: 6, Steps: 29948 | Train Loss: 0.30373 Vali Loss: 0.457
EarlyStopping counter: 3 out of 3
Early stopping
Train ended. Total time 2:36:46.017572, per epoch 0:26:07.669595

Loading the best model from scratch/FEDformer_Total/checkpoint.pth

>>>>>>> testing : FEDformer_Total <<<<<<<<
Preds and Trues shape: (3142, 14, 1) (3142, 14, 1)
test: rmse:182.22, mae:30.193, msle: 1.4667, r2: 0.48079
Preds and Trues shape: (3142, 14, 1) (3142, 14, 1)
val: rmse:85.874, mae:21.66, msle: 1.3675, r2: 0.492
Preds and Trues shape: (1916620, 14, 1) (1916620, 14, 1)
train: rmse:69.171, mae:14.942, msle: 1.3841, r2: 0.70686
Experiment ended at 2023-10-02 00:50:56.525003, runtime 2:41:03.781458
